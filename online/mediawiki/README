
HOW TO SETUP A TRUST-COLORED WIKI

Note: this covers only how to set up a local Mediawiki server that
serves colored pages.  

1) Install Mysql, Apache, PHP

2) Download the latest version of MediaWIki

3) Configure it in the normal way -- Follow the instructions you get by going
to the website for the first time

Now, customize it:

$ cd /var/lib/mediawiki/
$ sudo cp ~/wikitrust/online/mediawiki/extensions/* extensions/
$ sudo cp ~/wikitrust/online/mediawiki/skins/* skins/
$ sudo chown -R www-data:www-data extensions/Trust
$ sudo chown -R www-data:www-data skins/Trust.php
$ sudo chown -R www-data:www-data skins/trust

Developers may want to do instead: 

$ sudo ln -s ~/wikitrust/online/mediawiki/extensions/* extensions/
$ sudo ln -s ~/wikitrust/online/mediawiki/skins/* skins/

and then play with permissions to make this work. 

6) In LocalSettings.php, change these lines

$wgSitename         = "The WikiTrust Project";
$wgDefaultSkin = 'trust'; 

And, add this line to the bottom of the file
# Trust extension
require_once( $IP . "/extensions/Trust/Trust3.php" );

================================================================
Ian, from here on, can you revise the instructions? -Luca


require( $IP . "/extensions/ExtMan.php" );


Optionally, if you like, download and install the following MW extensions:

ParserFunctions
Cite
CategoryTree
wikihiero/
ImageMap/
AntiSpoof/
CharInsert/
ExpandTemplates
Filepath
Gadgets/
LabeledSectionTransclusion/
Poem/
Quiz/
SyntaxHighlight_GeSHi/

Do this by checking them out of svn
svn checkout http://svn.wikimedia.org/svnroot/mediawiki/trunk/extensions

And then linking the corresponding directory into the extensions directory.

For example, 
ln -s /path/to/Cite ./extensions/

8) Setup Math mode
cd mediawiki_install_path/math
$ make
$ mkdir ../images/tmp
$ mkdir ../images/math
$ sudo chown -R www-data ../images/

9) Edit includes/Defines.php

!!!!!!!! This does not apply any more!!! 

Change this line:
define( "FS_CACHE_LOCAL_SITE", "/bigspace/cluster/rev_text" );

To point to wherever on your system the base directory of the text files is.

11) Load the striped content into the local db. You can use the tool
server/scripts/load_all_files to do this. This script requires the customized server/scripts/mwdumper.jar file  and
java 2, v1.6.

You will also need to edit load_all_files to point to mwdumper.jar on your
system.

10) Open a mysql terminal, and exicute this command:

UPDATE text SET old_flags ='utf-8,fs_cache'  ;

This marks all of the revisions to look at the external store for text content.
It also marks all of the content as being utf-8.

11) touch LocalSettings.php

Touching LocalSettings.php invalidates the cache, and any changes you have made
will now be refleced.

12) Look at a page --> What happens?
